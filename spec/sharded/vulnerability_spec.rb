require 'spec_helper'

RSpec.describe Stinger::Sharded::Vulnerability do
  include_context 'set up sharded data'

  subject(:vuln) do
    Stinger::Sharded::Vulnerability.using(:client_3).first
  end

  it 'has two vulnerabilities in the DB' do
    vuln_count =
      Stinger::Sharded::Vulnerability
      .using(:client_3)
      .count

    expect(vuln_count).to eq(2)
  end

  it 'belongs to asset' do
    expect(vuln.asset.id).to eq(sharded_asset.id)
  end

  it 'belongs to a cve' do
    expect(vuln.cve).to eq(apple_cve)
  end
end
